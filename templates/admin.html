<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <title>Admin | Projo </title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
    </style>
</head>
<body>
    <h1>Admin</h1>
    <!-- <div class="upload-form">
        <form>
            <div>
                <label for="file">Select CSV File:</label>
                <input type="file" id="file" name="file" accept=".csv" required>
            </div>
            <button type="submit">Upload </button>
        <form>
    </div> -->
    <div class="flex gap-4">
        <p onclick="loadTasks('/tasks?=pending')">Pending</p>
        <p onclick="loadTasks('/tasks?=processing')">Processing</p>
        <p onclick="loadTasks('/tasks?=completed')">Completed</p>
        <p onclick="loadTasks('/tasks?=failed')">Failed</p>
        <p onclick="loadTasks('/tasks')">All</p>
    </div>
   
        <ul id="tasksContainer">

        </ul>
    </div>

<script>
async function loadTasks(url) {
    try {
        const response = await fetch(url);
        const tasks = await response.json();

        const container = document.getElementById('tasksContainer');
        container.innerHTML = '';

        tasks.forEach(task => {
            const taskEl = document.createElement('li');
            taskEl.className = `bg-gray-50 w-[660px]`;
            taskEl.innerHTML = `
                <div class="flex flex-col w-full  leading-1.5 p-4 bg-neutral-secondary-soft rounded-e-base rounded-es-base my-4">
                        <div class="flex items-center justify-between
                                    space-x-1.5 rtl:space-x-reverse w-full">
                            <span class="text-md font-semibold text-heading mb-4">${task.filename}</span>
                            <span class="text-md text-body">${task.status}</span>
                        </div>
                        <p class="text-sm text-body">Uploaded at : ${task.created_at}</p>
                        <p class="text-sm text-body">Started Processing at : ${task.started_at}</p>
                        <p class="text-sm text-body"> Completed Processing at : ${task.completed_at}</p>
                    </div>
            `;
            container.appendChild(taskEl);
        });
    } catch (error) {
        console.error('Failed to load tasks:', error);
    }
}

</script>

</body>
</html>